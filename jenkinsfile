pipeline{
   
    tools {
      jdk 'myjava'
      maven 'mymaven'
    }
    
    agent none
    stages{
        stage('Checkout'){
            agent {label 'PASlave'}
            steps{
                git 'https://github.com/arunsangubhatla/DevOpsClassCodes.git'
            }
        }
        
        stage('Deploy'){
          agent {label 'PASlave'}
          steps{
              sh "sh docker.sh "
          }
        }
     
        stage('SeliniumTest'){
	    agent {label 'PASlave'}
            steps{
              sh 'mvn -f websitetestproj/pom.xml test'
            }

            post{
              failure{
                 sh 'Testing failed do cleanup..."
                //sh 'sh $WORKSPACE/DevOpsClassCodes/dockercleanup.sh'
		//sh 'docker system prune -a'
              }
            }
        }
    }
}
